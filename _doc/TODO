start app: php -S localhost:8000 -t public
.\vendor\bin\phpunit tests


To copy a database from yourapp to yourapp_staging:

# turn off the web dynos in staging
heroku maintenance:on -a yourapp-staging

# if you have non-web-dynos, do them too
heroku ps:scale worker=0 -a yourapp-staging

# backup the staging database if you are paranoid like me (optional)
heroku pg:backups capture -a yourapp-staging

# execute the copy
heroku pg:copy your-app::DATABASE_URL DATABASE_URL -a yourapp-staging
Then when it's complete, turn staging back on:

# this is if you have workers, change '1' to whatever
heroku ps:scale worker=1 -a yourapp-staging

heroku maintenance:off -a yourapp-staging


<b>Fatal error</b>: Uncaught Error: Call to undefined method Laravel\Lumen\Application::handleException() in
C:\xampp\htdocs\greybox\vendor\laravel\lumen-framework\src\Concerns\RegistersExceptionHandlers.php:67
Stack trace:
#0 C:\xampp\htdocs\greybox\vendor\laravel\lumen-framework\src\Concerns\RegistersExceptionHandlers.php(55):
Laravel\Lumen\Application-&gt;handleShutdown()
#1 [internal function]: Laravel\Lumen\Application-&gt;Laravel\Lumen\Concerns\{closure}()
#2 {main}
thrown in <b>C:\xampp\htdocs\greybox\vendor\laravel\lumen-framework\src\Concerns\RegistersExceptionHandlers.php</b> on
line <b>67</b><br />

TODO: Fakturoid webhooks


TODO: nové
Prosím Tě, bylo by možné uživateli testo@va.ci (id 292) dohodit nějaké osoby do autofillu? Potřeboval bych implementovat mazání lidí z autofillu, ale zároveň si nechci mazat svoje lidi a ani nechci vytvářet fejkové přihlášky na Hradec :smile: Díky moc (edited)
Ideálně co nejvíc, klidně stejné hodnoty
Václav Soukup 1:07 PM
Hele a jak je chceš mazat? Já ti v té službě dávám všechny lidi, které ten daný člověk už někdy zaregistroval
git bot 1:09 PM
Myslel jsem pomocí metody delete person https://greybox.docs.apiary.io/#reference/0/people/delete-person
Když jsem třeba v minulosti registroval někoho, kdo už odešel z klubu, ať mi tam nepřekáží
Nebo se ta metoda k tomuhle použít nedá?
Václav Soukup 1:10 PM
To ti neprojde, protože ten člověk je už někde zaregistrovaný.
git bot 1:10 PM
Ahaa, takže to momentálně nijak nejde zařídit, jo?
Václav Soukup 1:10 PM
Nejde
To musíme nějak vymyslet
Asi ti budu muset udělat novou službu pro seznam lidí do autofillu
Tam budu automaticky dávat všechny už zaregistrované, ale nebudou tam constraints, takže je bude možné mazat.
git bot 1:13 PM
Ok tak pohoda, já to nechám zatím viset v Trellu
Asi to není teď prioritní
Václav Soukup 1:13 PM
Ok
git bot 1:22 PM
Jinak potom teda kdyžtak sepiš ty věci, co bych měl udělat přednostně, a při chvíli na ně sednu
Václav Soukup 1:32 PM
1) Formulář pro zadání fakturačních údajů - název*, adresa (zase rozdělené na ulice, město, zip), IČ, DIČ      *povinné
2) Tabulka s přehledem přihlášených lidí na turnaji pro organizátora - budu ti muset na to udělat nějakou servisu, ještě tam není. Každopádně můžeš počítat se sloupci: Jméno, role (debatér/rozhodčí/dozor), tým, ubytování, vegetarián, přihlásil (jméno nebo email), poznámka
git bot 1:55 PM
1) a) Takže název bude vždy povinný? Nebo se můžu rozhodnout vůbec neměnit fakturační údaje a zůstane tam e-mail jako doteď?
b) Pokud název bude vždy povinný, mám do toho políčka předvyplňovat e-mail, nebo ho nechat prázdné?
c) Bude možnost nějak získat předchozí fakturační údaje pro předvyplnění, nebo budou muset vždycky být zadané znovu?
2) Admina teda poznám podle admin: true na user/id, jo? A nebylo by praktičtější (vzhledem k budoucímu rozšíření) posílat třeba pole role s možnostmi none, admin, organizer atd, ať jsme připravení na víc rolí do budoucna?
Václav Soukup 2:00 PM
1) Hele, já můžu mít k jednomu uživateli více fakturačních údajů (někteří to dokonce i využijí). Takže by tam mohlo být něco jako defaultní, vybrat z již zadaných, přidat nový.
2) Tak tam dejte to role a hodnoty, které navrhuješ.
git bot 2:05 PM
1) Na tohle je API nachystané, nebo ještě ne? A co a) a b)?
2) To musíš napřed změnit Ty v API, ne?
Václav Soukup 2:13 PM
1) API je nachystané ...téměř. Můžeš vytvářet libovolný počet klientů a ti jsou vázaní na uživatele. https://greybox.docs.apiary.io/#reference/0/clients
a) Asi bych u toho výběru fakturačních údajů zobrazil defaultní variantu, která bude email uživatele.
b) Já bych defaultně jenom řekl, že fakturační údaje budou jenom email a teprve na kliknutí zobrazil ten formulář pro úpravy.
2) Jj, musím, ale můžeš počítat s těmito hodnoty. Já to do API dodělám podle tvého návrhu.
git bot 2:18 PM
Dobře, super :slightly_smiling_face: Dnes ani zítra se do toho nejspíš nepustím, tak jen potom dej vědět, až to bude ready
Václav Soukup 2:20 PM
Ok. Já se k tomu dneska určitě taky nedostanu, ale mohl bych asi zítra večer něco zvládnout.
Udělal jsem už pár změn ohledně té slevy, ale budu to potřebovat otestovat a trochu se bojím to nasazovat teď, když se bude nejvíc lidí přihlašovat

Pro Kuxu TODO: rozdělení note u člověka a registrace
Checkbox - chci se stát členem ADK + nějaký tooltip

Fakturoid errors TODO:
"fakturoidMessage": "{\"errors\":{\"due\":[\"Datum splatnosti v minulosti\"],\"client_name\":[\"je povinná položka\"],\"subject_id\":[\"Kontakt neexistuje.\"]}}",
    "fakturoidCode": 422

Kuxa TODO:
Když posílám požadavek na vytvoření týmu, přichází mi v odpovědi i event. Mám teda při registraci týmu posílat i ID turnaje, jo? V apiary to nikde není totiž   Aha, to je taky relikt z předchozí verze.   Asi bych to tam nechal
Teď jsem poslal registraci s tím, že člověk byl autofillnutý (takže jsem předtím neposílal person a jen jsem použil IDčko), a u většiny polí mi to vrátilo null. Mně to nevadí, ty políčka nepoužívám, ale jen jsem se chtěl ujistit, jestli to je správný chování, nebo to je nějaký bug v důsledku toho autofillu
2. Implementuješ do faktur překlady? Konkrétně co se dívám tak to je u rolí (resp. invoiceLines[0].name) a unit_name (invoiceLines[0].unitName)
2. Implementuju, ale strašně se mi do toho nechce :smile:
S tím organizátorem už se mi to stalo, budu to muset nějak ošetřit.
Ještě bychom měli vyřešit rušení registrací, ale to asi počká do příštího sprintu :D
git bot 6:22 PM
A kdybych zavolal GET registration, tak mi to vyplivne úplně všechny registrace, i minulé, jo?
Václav Soukup 6:23 PM
Teď to vyplyne fakt všechny
git bot 6:23 PM
Jo, ok
Spěchat s tím nemusíš, než se k tomu dostanu, mám důležitějších věcí tak na týden čistýho času :smile:
git bot 8:11 PM
A ještě mám spíš osobní otázku - jak to bude s platbama, když se bude registrace platit zvlášť? Třeba u nás, kdy nás registruju já, ale platbu posíláme každý zvlášť
Václav Soukup 8:17 PM
Když to pošlete se správným variabilním symbolem, tak fakturoid to sečte
git bot 8:24 PM
Geniální :heart:
git bot 8:30 PM
Ještě mám drobnost, se kterou se budeš srát 2 hodiny a ovlivní 0,001 % výsledku - u unit_name se neskloňuje, viz "1 osob" :confused: :smile:
image.png
image.png


Václav Soukup 8:30 PM
image.png
image.png


:joy:
1

git bot 8:31 PM
Chápu :smile: :smile:
Václav Soukup 8:31 PM
to už tam mám delší dobu
git bot 8:31 PM
Jj :smile:


Vašek TODO:
Drop user.person_id
Vyřešit posílání api_token u update user
Opravit routy podle https://stackoverflow.com/questions/34182806/multiple-route-file-instead-of-one-main-route-file-in-laravel-5
Udělat heslo nullovatelné a vynullovat po resetu.
Zhezčit mail
Vyřešit evidenci žádostí o reset hesla
Vyřešit hustotu posílání reset password mailů a jejich hromadění v DB

individual points: http://www.debating.net/ADK/Vysledky/JP04.htm + mails

TODO:
get the delete button back
strip privileges
prepocitavani IB a vitezstvi debaty
kontrola integrity
stylesheet pro tisk
do budoucna: hezke URL http://httpd.apache.org/docs-2.0/mod/mod_rewrite.html, Query String

homepage:
	nejaktualnejsi debaty
	turnaje (do >= date(), data, misto)
	zebricky aktualnich soutezi (z kazdeho jazyka unlocked nebo alespon nejnovejsi -- podle konce)
	top10 IB
